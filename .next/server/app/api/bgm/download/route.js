"use strict";(()=>{var e={};e.id=5782,e.ids=[5782],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1282:e=>{e.exports=require("child_process")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},1764:e=>{e.exports=require("util")},5115:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>j,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>b,staticGenerationAsyncStorage:()=>v});var i={};t.r(i),t.d(i,{GET:()=>w,POST:()=>f});var n=t(9303),o=t(8716),a=t(670),s=t(7070),u=t(1282),d=t(1764),l=t(5315),p=t.n(l),c=t(629),m=t.n(c),g=t(7677);async function f(e){try{let r=await e.json();if(!r.trackId||!r.title||!r.url)return s.NextResponse.json({error:"BGM 정보가 필요합니다."},{status:400});let{trackId:t,title:i,artist:n,url:o,genre:a,mood:u,duration:d}=r,l=p().join(process.cwd(),"public","bgm");await m().mkdir(l,{recursive:!0});let c=(0,g.Z)(),f=`${i.replace(/[^a-z0-9가-힣]/gi,"_")}_${t}.mp3`,w=p().join(l,f),x=await fetch(o);if(!x.ok)throw Error("BGM 다운로드 실패");let h=Buffer.from(await x.arrayBuffer());await m().writeFile(w,h);let v=await m().stat(w),b=p().join(l,`${f}.json`),j={trackId:t,title:i,artist:n,genre:a,mood:u,duration:d,downloadDate:new Date().toISOString(),fileSize:v.size};return await m().writeFile(b,JSON.stringify(j,null,2)),s.NextResponse.json({success:!0,data:{downloadId:c,fileName:f,filePath:`/bgm/${f}`,fileSize:v.size,metadata:{trackId:t,title:i,artist:n,genre:a,mood:u,duration:d}}})}catch(e){return console.error("BGM 다운로드 API 오류:",e),s.NextResponse.json({error:"BGM 다운로드에 실패했습니다.",details:e instanceof Error?e.message:"알 수 없는 오류"},{status:500})}}async function w(){return s.NextResponse.json({message:"SurvivingVid Pixabay BGM 다운로드 API",endpoints:{POST:"/api/bgm/download",description:"Pixabay BGM 다운로드"},usage:{trackId:"number (필수) - 트랙 ID",title:"string (필수) - 트랙 제목",artist:"string (필수) - 아티스트",url:"string (필수) - 다운로드 URL",genre:"string - 장르",mood:"string - 분위기",duration:"number - 재생 시간(초)"}})}(0,d.promisify)(u.exec);let x=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/bgm/download/route",pathname:"/api/bgm/download",filename:"route",bundlePath:"app/api/bgm/download/route"},resolvedPagePath:"C:\\projects\\survivingvid\\src\\app\\api\\bgm\\download\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:v,serverHooks:b}=x,j="/api/bgm/download/route";function y(){return(0,a.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:v})}},7677:(e,r,t)=>{t.d(r,{Z:()=>d});let i=require("crypto");var n=t.n(i);let o={randomUUID:n().randomUUID},a=new Uint8Array(256),s=a.length,u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));let d=function(e,r,t){if(o.randomUUID&&!r&&!e)return o.randomUUID();let i=(e=e||{}).random||(e.rng||function(){return s>a.length-16&&(n().randomFillSync(a),s=0),a.slice(s,s+=16)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,r){t=t||0;for(let e=0;e<16;++e)r[t+e]=i[e];return r}return function(e,r=0){return u[e[r+0]]+u[e[r+1]]+u[e[r+2]]+u[e[r+3]]+"-"+u[e[r+4]]+u[e[r+5]]+"-"+u[e[r+6]]+u[e[r+7]]+"-"+u[e[r+8]]+u[e[r+9]]+"-"+u[e[r+10]]+u[e[r+11]]+u[e[r+12]]+u[e[r+13]]+u[e[r+14]]+u[e[r+15]]}(i)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[9276,5972],()=>t(5115));module.exports=i})();