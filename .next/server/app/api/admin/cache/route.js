"use strict";(()=>{var e={};e.id=2269,e.ids=[2269],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9515:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var a={};s.r(a),s.d(a,{DELETE:()=>h,GET:()=>l});var r=s(9303),i=s(8716),c=s(670),n=s(7070),o=s(4225);async function l(e){try{let t=new URL(e.url),s=t.searchParams.get("action"),a=t.searchParams.get("namespace")||"all";switch(console.log(`ðŸ—„ï¸ Cache API request: action=${s}, namespace=${a}`),s){case"stats":return function(e){let t=u(e),s={};for(let[e,a]of Object.entries(t))s[e]=a.getStats();let a={totalEntries:Object.values(s).reduce((e,t)=>e+t.totalEntries,0),totalHits:Object.values(s).reduce((e,t)=>e+t.hitCount,0),totalMisses:Object.values(s).reduce((e,t)=>e+t.missCount,0),totalMemoryUsage:Object.values(s).reduce((e,t)=>e+t.memoryUsage,0),overallHitRate:0};return a.overallHitRate=a.totalHits+a.totalMisses>0?a.totalHits/(a.totalHits+a.totalMisses):0,n.NextResponse.json({namespace:e,timestamp:new Date().toISOString(),caches:s,overall:a,performance:{memoryEfficiency:a.totalMemoryUsage>0?a.totalEntries/a.totalMemoryUsage:0,hitRateScore:a.overallHitRate,totalCaches:Object.keys(t).length}})}(a);case"clear":return m(a);case"keys":return function(e){let t=u(e),s={};for(let[e,a]of Object.entries(t))s[e]=a.keys();return n.NextResponse.json({namespace:e,keys:s,totalKeys:Object.values(s).reduce((e,t)=>e+t.length,0),timestamp:new Date().toISOString()})}(a);case"info":return n.NextResponse.json({cacheSystem:"Smart Cache v1.0",features:["TTL (Time To Live) support","LRU (Least Recently Used) eviction","Namespace isolation","Performance monitoring","Memory usage tracking","Automatic cleanup"],namespaces:{default:"General purpose cache (max: 500 entries)",api:"API response cache (max: 200 entries, TTL: 5min)",scripts:"Generated scripts cache (max: 100 entries, TTL: 30min)",images:"Generated images cache (max: 1000 entries, TTL: 1hr)"},configuration:{cleanupInterval:"60 seconds",defaultTTL:"5 minutes",compressionEnabled:!1,metricsEnabled:!0},timestamp:new Date().toISOString()});default:return n.NextResponse.json({error:"Invalid action",availableActions:["stats","clear","keys","info"],namespaces:["all","default","api","scripts","images"]},{status:400})}}catch(e){return console.error("âŒ Cache API error:",e),n.NextResponse.json({error:"Internal server error",message:e.message},{status:500})}}async function h(e){try{let t=new URL(e.url),s=t.searchParams.get("namespace")||"all",a=t.searchParams.get("key");if(a&&"all"!==s)return function(e,t){let s=u(e);if(0===Object.keys(s).length)return n.NextResponse.json({error:"Invalid namespace",namespace:e},{status:400});let a=Object.values(s)[0].delete(t);return n.NextResponse.json({namespace:e,key:t,deleted:a,timestamp:new Date().toISOString()})}(s,a);return m(s)}catch(e){return console.error("âŒ Cache DELETE error:",e),n.NextResponse.json({error:"Internal server error",message:e.message},{status:500})}}function m(e){let t=u(e),s={};for(let[e,a]of Object.entries(t)){let t=a.getStats();a.clear(),s[e]=t.totalEntries}let a=Object.values(s).reduce((e,t)=>e+t,0);return console.log(`ðŸ§¹ Cache cleared: namespace=${e}, entries=${a}`),n.NextResponse.json({namespace:e,cleared:s,totalCleared:a,timestamp:new Date().toISOString()})}function u(e){switch(e){case"default":return{default:o.I5};case"api":return{api:o.hH};case"scripts":return{scripts:o.Ul};case"images":return{images:o.U_};default:return{default:o.I5,api:o.hH,scripts:o.Ul,images:o.U_}}}let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/cache/route",pathname:"/api/admin/cache",filename:"route",bundlePath:"app/api/admin/cache/route"},resolvedPagePath:"C:\\projects\\survivingvid\\src\\app\\api\\admin\\cache\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:f}=p,v="/api/admin/cache/route";function y(){return(0,c.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},4225:(e,t,s)=>{s.d(t,{I5:()=>r,U_:()=>n,Ul:()=>c,hH:()=>i});class a{constructor(e={}){this.cache=new Map,this.maxSize=e.maxSize||1e3,this.enableMetrics=e.enableMetrics??!0,this.namespace=e.namespace||"default",this.stats={totalEntries:0,hitCount:0,missCount:0,hitRate:0,memoryUsage:0,evictions:0,averageTTL:0},this.cleanupInterval=setInterval(()=>{this.cleanup()},6e4),console.log(`ðŸ—„ï¸ Smart Cache initialized: namespace=${this.namespace}, maxSize=${this.maxSize}`)}set(e,t,s={}){try{let a=this.getNamespacedKey(e),r=s.ttl||3e5,i=Date.now();this.cache.size>=this.maxSize&&!this.cache.has(a)&&this.evictLRU();let c={data:t,timestamp:i,ttl:r,hits:0,lastAccessed:i,metadata:{createdAt:i,namespace:this.namespace}};return this.cache.set(a,c),this.updateStats(),console.log(`ðŸ’¾ Cache SET: ${e} (TTL: ${r}ms)`),!0}catch(e){return console.error("âŒ Cache SET error:",e),!1}}get(e){try{let t=this.getNamespacedKey(e),s=this.cache.get(t);if(!s)return this.recordMiss(),console.log(`ðŸ” Cache MISS: ${e}`),null;let a=Date.now();if(a-s.timestamp>s.ttl)return this.cache.delete(t),this.recordMiss(),console.log(`â° Cache EXPIRED: ${e}`),null;return s.hits++,s.lastAccessed=a,this.recordHit(),console.log(`âœ… Cache HIT: ${e} (hits: ${s.hits})`),s.data}catch(e){return console.error("âŒ Cache GET error:",e),this.recordMiss(),null}}delete(e){let t=this.getNamespacedKey(e),s=this.cache.delete(t);return s&&(console.log(`ðŸ—‘ï¸ Cache DELETE: ${e}`),this.updateStats()),s}has(e){let t=this.getNamespacedKey(e),s=this.cache.get(t);return!!s&&(!(Date.now()-s.timestamp>s.ttl)||(this.cache.delete(t),!1))}clear(){let e=this.cache.size;this.cache.clear(),console.log(`ðŸ§¹ Cache CLEAR: ${e} entries removed`),this.updateStats()}getStats(){return this.updateStats(),{...this.stats}}keys(){let e=Date.now(),t=[];for(let[s,a]of this.cache.entries())e-a.timestamp<=a.ttl&&t.push(s.replace(`${this.namespace}:`,""));return t}async warm(e,t={}){console.log(`ðŸ”¥ Cache warming: ${Object.keys(e).length} entries`);let s=Object.entries(e).map(async([e,s])=>this.set(e,s,t));await Promise.all(s),console.log(`âœ… Cache warming completed`)}mget(e){let t={};for(let s of e)t[s]=this.get(s);return t}mset(e,t={}){for(let[s,a]of Object.entries(e))this.set(s,a,t)}async warmWithFn(e,t,s={}){console.log(`ðŸ”¥ Async cache warming: ${e.length} entries`);let a=e.map(async e=>{try{let a=await t(e);return this.set(e,a,s)}catch(t){return console.error(`âŒ Cache warming failed for key ${e}:`,t),!1}});await Promise.all(a),console.log(`âœ… Async cache warming completed`)}cleanup(){let e=Date.now(),t=0;for(let[s,a]of this.cache.entries())e-a.timestamp>a.ttl&&(this.cache.delete(s),t++);t>0&&(console.log(`ðŸ§¹ Cache cleanup: ${t} expired entries removed`),this.updateStats())}evictLRU(){let e="",t=Date.now();for(let[s,a]of this.cache.entries())a.lastAccessed<t&&(t=a.lastAccessed,e=s);e&&(this.cache.delete(e),this.stats.evictions++,console.log(`ðŸ—‘ï¸ Cache LRU eviction: ${e}`))}getNamespacedKey(e){return`${this.namespace}:${e}`}recordHit(){this.enableMetrics&&(this.stats.hitCount++,this.updateHitRate())}recordMiss(){this.enableMetrics&&(this.stats.missCount++,this.updateHitRate())}updateHitRate(){let e=this.stats.hitCount+this.stats.missCount;this.stats.hitRate=e>0?this.stats.hitCount/e:0}updateStats(){if(!this.enableMetrics)return;this.stats.totalEntries=this.cache.size;let e=0,t=0;for(let s of this.cache.values())e+=2*JSON.stringify(s.data).length,t+=s.ttl;this.stats.memoryUsage=e,this.stats.averageTTL=this.cache.size>0?t/this.cache.size:0}destroy(){this.cleanupInterval&&clearInterval(this.cleanupInterval),this.clear(),console.log(`ðŸ’¥ Cache destroyed: namespace=${this.namespace}`)}}let r=new a({namespace:"default",maxSize:500}),i=new a({namespace:"api",maxSize:200,ttl:3e5}),c=new a({namespace:"scripts",maxSize:100,ttl:18e5}),n=new a({namespace:"images",maxSize:1e3,ttl:36e5})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[9276,5972],()=>s(9515));module.exports=a})();